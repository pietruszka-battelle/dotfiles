#!/bin/bash

delete_branch_protections()
{
	[ -z $1 ] && { echo 'You must provide the REPO'; exit 1; }
	REPO=$1
	BRANCH=${2:-main}
	METHOD='--method DELETE '
	HEADERS='-H "Accept: application/vnd.github+json" -H "X-GitHub-Api-Version: 2022-11-28"'
	API="/repos/battellecube/$REPO/branches/$BRANCH/protection"
	echo gh api $METHOD $HEADERS $API
}

WL=kevin-pietruszka-$(date +%s)
cube_ workload create -n $WL
delete_branch_protections $WL
echo $WL
